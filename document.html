---
layout: default
---

  <div class="content">
    <h1>Document</h1>

     <div class="desc">
      <p>
       Documents are instances of <a href="collection">Collections</a>.
     </p>
    </div>

     <div class="note">
      Document fields usually start with a "<u>$</u>" so that the Tyranid fields do not conflict with the underlying data being modeled.
    </div>

     <article id="$asOf">
       <b class="method"></b>
       <b class="server"></b>
       <span class="sig">$asOf(<i>date</i>): void</span>
       <p>This rolls back the object in-place to the given date if its collection supports <a href="/#historical">historical data</a>.</p>
       <p><u>date</u> can be either an instance of Date or the number of UTC milliseconds (<u><i>Date</i>.getTime()</u>).</p>
     </article>

     <article id="$clone">
       <b class="method"></b>
       <b class="server"></b>
       <b class="client"></b>
       <span class="sig">$clone(): <a href="document">Document</a></span>
       <p>This performs a deep in-memory clone of the current document that also retains the class into the cloned document.</p>
     </article>

     <article id="$copy">
       <b class="method"></b>
       <b class="server"></b>
       <span class="sig">$copy(obj): void</span>
       <p>This copies values from <u>obj</u> into the current object.  If the target object has <a href="/#historical">historical</a> properties like
         <a href="#_history"><u>_history</u></a> or <a href="#$orig"><u>$orig</u></a> these will not be copied.</p>
     </article>

     <article id="_history">
       <b class="property"></b>
       <b class="server"></b>
       <b class="client"></b>
       <span class="sig">_history: <i>snapshot</i>[]</span>
       <p>If <a href="/#historical">historical data</a> is enabled for this collection, then this field will contain an array of historical snapshots
         for this document.</p>
       <p>
         The format of each <i>snapshot</i> document is:

       <table class="def">
<thead>
  <tr><th>Object Structure<th>Type<th>Notes
</thead>
<tr><td>{</td>
<tr><td>  a:<td><a href="/#uids">UID</a><td>A UID referencing the author of the change.
<tr><td>  c:<td>String<td>An optional comment about the change.
<tr><td>  o:<td><i>Date in UTC ms</i><td>The date this snapshot was taken (from <i>Date</i>.getTime()).
<tr><td>  p:<td><i>patch</i><td>The patch object containing the differences.
<tr><td>}</td>
</table>
       </p>
       <p>Users of Tyranid do not usually need to work with this history property directly.</p>
       <p>Also, if you are using historical data, do not have a field named "history" as Tyranid will overwrite it with this array.</p>
     </article>

     <article id="$id">
       <b class="property"></b>
       <b class="server"></b>
       <b class="client"></b>
       <span class="sig">$id: <i>id type</i></span>
       <p>This returns the id for this document.  This is usually (but not always) the contents of <u>_id</u>.
     </article>

     <article id="$insert">
       <b class="method"></b>
       <b class="server"></b>
       <b class="async"></b>
       <span class="sig">$insert(options: <a href="collection#options">Options</a>?): <a href="document">Document</a></span>
     </article>

     <article id="$label">
       <b class="property"></b>
       <b class="server"></b>
       <b class="client"></b>
       <span class="sig">$label: string</span>
       <p>This returns the label for this document.  See <a href="/#labels">labels</a>.
     </article>

     <article id="$model">
       <b class="property"></b>
       <b class="server"></b>
       <b class="client"></b>
       <span class="sig">$model: <a href="collection">Collection</a></span>
       <p>This is a reference to the collection of this document.  <u>this.$model</u> is equivalent to <u>this.constructor</u>.
     </article>

     <article id="$orig">
       <b class="property"></b>
       <b class="server"></b>
       <span class="sig">$orig: object</span>
       <p>This will contain all of the original values for the document if <a href="/#historical">historical data</a> is enabled for this collection.</p>
     </article>

     <article id="$populate">
       <b class="method"></b>
       <b class="server"></b>
       <b class="async"></b>
       <span class="sig">$populate(fields, <a href="/#denormalization">denormal</a>: boolean): this</span>
       <p>
         This is equivalent to <u>doc.$model.<a href="collection#populate">populate(fields, doc, denormal)</a></u>.
       </p>
       <p>
        Also see <a href="/#population">Population</a> for more information and examples.
      </p>
     </article>

     <article id="$remove">
       <b class="method"></b>
       <b class="server"></b>
       <b class="async"></b>
       <span class="sig">$remove(options: <a href="collection#options">Options</a>?): void</span>
       <p>This removes the current document from the database.</p>
     </article>

     <article id="$save">
       <b class="method"></b>
       <b class="server"></b>
       <b class="client"></b>
       <b class="async"></b>
       <span class="sig">$save(options: <a href="collection#options">Options</a>?): <a href="document">Document</a></span>
       <p>This method will either update or insert the object based on whether it has an _id.</p>
       <p>When updating, the entire object is <b>replaced</b>.  See <a href="document#$update"><u>$update()</u></a> to only update instead of replace.</p>
       <p>If the document ends up being inserted, the document returned by this method will have its <u>_id</u> set.
     </article>

     <article id="$toClient">
       <b class="method"></b>
       <b class="server"></b>
       <span class="sig">$toClient(): object</span>
       <p>
        This creates a new POJO out of this document.  Values are copied by reference (not deep-cloned!).
       </p>
     </article>

     <article id="$uid">
       <b class="property"></b>
       <b class="server"></b>
       <b class="client"></b>
       <span class="sig">$uid: string</span>
       <p>This returns the <a href="/#uids">UID</a> for this document.</p>
     </article>

     <article id="$update">
       <b class="method"></b>
       <b class="server"></b>
       <b class="async"></b>
       <span class="sig">$update(options: <a href="collection#options">Options</a>?)</span>
       <p>This updates the server document with the values in this object.  Note that the document is <i>not</i> replaced.  See
         <a href="document#$save"><u>$save()</u></a> if you want to do a full replace.</p>
     </article>

     <article id="$validate">
       <b class="method"></b>
       <b class="server"></b>
       <span class="sig">$validate(): <a href="validationError">ValidationError</a>[]</span>
       <p>This validates the current document according to the validation rules specified by the metadata for this collection.</p>
     </article>

  </div>
